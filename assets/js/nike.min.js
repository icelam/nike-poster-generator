var nikePosterGenerator=function(){var e=!0,t=!1,a=new Image,o=new Image;o.src="assets/images/just-do-it.svg";var i=document.getElementById("canvas"),h=i.getContext("2d"),n=function(){if(t){switch(document.getElementById("orientation").value){case"1":i.width=a.width,i.height=a.height,h.transform(1,0,0,1,0,0);break;case"2":i.width=a.height,i.height=a.width,h.transform(0,1,-1,0,a.height,0);break;case"3":i.width=a.width,i.height=a.height,h.transform(-1,0,0,-1,a.width,a.height);break;case"4":i.width=a.height,i.height=a.width,h.transform(0,-1,1,0,0,a.width);break;default:i.width=a.width,i.height=a.height,h.transform(1,0,0,1,0,0)}h.drawImage(a,0,0),h.resetTransform(),h.globalCompositeOperation="saturation",h.fillStyle="hsl(0,0%,50%)",h.fillRect(0,0,i.width,i.height);var n=h.getImageData(0,0,i.width,i.height);l(n.data,document.getElementById("brightness").value),d(n.data,document.getElementById("contrast").value),h.putImageData(n,0,0),h.globalCompositeOperation="source-over",h.fillStyle="rgba(0, 0, 0, 0.5)",h.fillRect(0,0,i.width,i.height);var r=Math.floor(.07*i.width);h.font=r+'px Times,"Times New Roman","Microsoft JhengHei","Heiti TC",sans-serif',h.textAlign="center",h.textBaseline="top",h.fillStyle="white";for(var s=document.getElementById("slogan").value,g=Math.floor(i.width/2),m=Math.floor(i.height/2),c=Math.floor(.9*i.width),f=Math.floor(1.3*r),w=s.split(" "),u="",v=[],p=0;p<w.length;p++){var y=u+w[p]+" ";h.measureText(y).width>c&&p>0?(v.push(u),u=w[p]+" "):u=y}v.push(u);var b=m-Math.floor(v.length*f/2);for(p=0;p<v.length;p++)h.fillText(v[p],g,b),b+=f;var I=o.width/o.height,B=Math.floor(.03*i.width),T=B*I;h.drawImage(o,0,0,o.width,o.height,(i.width-T)/2,Math.floor(i.height-.06*i.height-B),T,B),e&&(document.getElementById("welcome").style.display="none",i.style.display="block",e=!1)}},r=function(e){return e<0?0:e>255?255:e},l=function(e,t){for(var a=0;a<e.length;a+=4)e[a]+=t/100*255,e[a+1]+=t/100*255,e[a+2]+=t/100*255},d=function(e,t){for(var a=128*(1-(t=t/100+1)),o=0;o<e.length;o+=4)e[o]=r(e[o]*t+a),e[o+1]=r(e[o+1]*t+a),e[o+2]=r(e[o+2]*t+a)};return{loadImage:function(){for(var e=document.getElementById("poster-source").files,o=0;o<e.length;o++){var i=e[o];i.type.match(/image.*/)?(a.src=URL.createObjectURL(i),a.onload=function(){t=!0,n()}):alert("Seleted file is not an image, please select another one.")}},drawImageOnCanvas:n,saveCanvas:function(){if(t){var e,a=(new Date).getTime(),o=document.createElement("a");if(i.msToBlob)e=i.msToBlob(),window.navigator.msSaveBlob(e,"IT-poster-"+a+".jpg");else{for(var h=i.toDataURL("image/jpeg").split(","),n=h[0].match(/:(.*?);/)[1],r=atob(h[1]),l=r.length,d=new Uint8Array(l);l--;)d[l]=r.charCodeAt(l);e=new Blob([d],{type:n}),document.body.appendChild(o),o.href=URL.createObjectURL(e),o.download="IT-poster-"+a+".jpg",o.click(),document.body.removeChild(o)}}},truncateColor:r}};